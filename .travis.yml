os: linux
dist: focal
group: stable
language: python
env: 
  - COSIGN_EXPERIMENTAL=1
services:
  - docker
jobs:
  include:
    - stage: "sleep 109"
      script:
        - echo arthanaharidas
        - docker login -u "arthanaharidas" -p "${DOCKER_HUB_PASSWORD}"
        - docker build -t hello-world-python .
   #     - docker tag hello-world-python arthanaharidas/python-hello-world
        - docker digest sha256:376406a7134f77b8ba329fe3f1e23fc17200c01ed0e68253fc324b07e1248b02
   #     - docker push arthanaharidas/python-hello-world
        - docker push sha256:376406a7134f77b8ba329fe3f1e23fc17200c01ed0e68253fc324b07e1248b02
        - export COSIGN_PASSWORD="${COS_PASSWORD}"
   #     - cosign sign --key cosign.key arthanaharidas/python-hello-world
        - cosign sign --key cosign.key sha256:376406a7134f77b8ba329fe3f1e23fc17200c01ed0e68253fc324b07e1248b02
        - yes | cosign sign --key cosign.key sha256:376406a7134f77b8ba329fe3f1e23fc17200c01ed0e68253fc324b07e1248b02
        - cosign verify --key cosign.pub sha256:376406a7134f77b8ba329fe3f1e23fc17200c01ed0e68253fc324b07e1248b02
        - docker logout
 
keys:
  - Key
